<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Example Work Queue with a Custom Work Item Type</title>
    <link rel="StyleSheet" href="css/batchprocess.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>BillingCenter Integration Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="p-claims.html#2362514">Other Integration Topics</a> : <a class="WebWorks_Breadcrumb_Link" href="batchprocess.29.01.html#2362514">Custom Batch Processing</a> : <a class="WebWorks_Breadcrumb_Link" href="batchprocess.29.14.html#2362514">Example Work Queues</a> : Example Work Queue with a Custom Work Item Type</span></div>
    <hr align="left" />
    <blockquote>
      <h4 class="H2B_-_Heading_2_Break"><a name="2362514">Example Work Queue with a Custom Work Item Type</a></h4>
      <div class="B_-_Body"><a name="2363952">The following Gosu code is an example of a custom work queue that uses a custom work item type for its work queue table. So, the code provides an implementation of the </a><span class="cv_-_computer_voice">createWorkItem</span> method in addition to the <span class="cv_-_computer_voice">findTargets</span> method to add work items for a batch to the work queue.</div>
      <div class="B_-_Body"><a name="2406199">The unit of work for the work queue is an activity that has not been viewed for five days or more. The process sends an email to the user assigned to the activity, and then it sets the escalation date on the activity to the current date. The work queue uses a custom work item type, so it uses the type its class declaration and constructor. </a></div>
      <PRE class="CF_-_Code_First_Line"><a name="2363953">uses gw.processes.WorkQueueBase</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2363954">uses gw.api.database.Query</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2363955">uses gw.api.database.DBFunction</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2363956">uses java.util.Iterator</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406052">uses gw.transaction.Transaction </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2363957">uses gw.api.email.EmailUtil</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406255">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405976">/**</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405977">&nbsp;* An example of batch processing implemented as a work queue that sends email</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405978">&nbsp;* to assignees of activities that have not been viewed for five days or more.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405979">&nbsp;*/</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405980">class MyWorkQueue extends WorkQueueBase &lt;Activity, </a><span class="s_-_strong">MyWorkItem</span>&gt; {</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405981">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405982">&nbsp;&nbsp;/**</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405983">&nbsp;&nbsp;&nbsp;* Let the base class register this type of custom batch processing by</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405984">&nbsp;&nbsp;&nbsp;* passing the batch processing type, the entity type the work queue item, and</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405985">&nbsp;&nbsp;&nbsp;* the target type for the units of work.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405986">&nbsp;&nbsp;&nbsp;*/</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405987">&nbsp;&nbsp;construct () {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405988">&nbsp;&nbsp;&nbsp;&nbsp;super (typekey.BatchProcessType.TC_NOTIFYUNVIEWEDACTIVITIES, </a><span class="s_-_strong">MyWorkItem</span>, Activity)</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405989">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405990">  }</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405991">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405992">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405993">&nbsp;&nbsp;/**</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405994">&nbsp;&nbsp;&nbsp;* Select the units of work for a batch run: activities that have not been</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405995">&nbsp;&nbsp;&nbsp;* viewed for five days or more.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405996">&nbsp;&nbsp;&nbsp;*/</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405997">&nbsp;&nbsp;override function findTargets (): Iterator  &lt;Activity&gt; {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405998">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2405999">&nbsp;&nbsp;&nbsp;&nbsp;// Query the target type and apply conditions: activities not viewed for 5 days or more</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406000">&nbsp;&nbsp;&nbsp;&nbsp;var targetsQuery = Query.make(Activity)</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406001">&nbsp;&nbsp;&nbsp;&nbsp;targetsQuery.compare(Activity#LastViewedDate.ProperyInfo.Name, LessThanOrEquals,</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2409116">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;java.util.Date.Today.addBusinessDays(-5))</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406003">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406004">&nbsp;&nbsp;&nbsp;&nbsp;return targetsQuery.select().iterator()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406005">&nbsp;&nbsp;}</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406006">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406120">&nbsp;&nbsp;/**</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406121">&nbsp;&nbsp;&nbsp;* Write a custom work item </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406123">&nbsp;&nbsp;&nbsp;*/</a></PRE>
      <PRE class="CF_-_Code_First_Line"><a name="2406086">&nbsp;&nbsp;override function </a><span class="s_-_strong">createWorkItem</span> (activity : Activity, safeBundle : Bundle) : WorkItem {</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406087">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406088">&nbsp;&nbsp;&nbsp;&nbsp;var customWorkItem = new </a><span class="s_-_strong">MyWorkItem</span>(safeBundle)</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406089">&nbsp;&nbsp;&nbsp;&nbsp;customWorkItem.Activity = activity</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406090">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406091">&nbsp;&nbsp;&nbsp;&nbsp;return workItem</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2406102">&nbsp;&nbsp;}</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406103">&nbsp;&nbsp;/**</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406104">&nbsp;&nbsp;&nbsp;* Process a unit of work: an activity not viewed for five days or more</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406010">&nbsp;&nbsp;&nbsp;*/</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406011">&nbsp;&nbsp;override function processWorkItem (workItem : </a><span class="s_-_strong">MyWorkItem</span>): void  {</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406012">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406013">&nbsp;// Get an object reference to the activity</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406014">&nbsp;&nbsp;&nbsp;&nbsp;var activity = workItem.Activity </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406015">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406016">&nbsp;&nbsp;&nbsp;&nbsp;// Send an email to the user assigned to the activity.</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406017">&nbsp;&nbsp;&nbsp;&nbsp;if (activity.AssignedUser.Contact.EmailAddress1 != null) {</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406018">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EmailUtil.sendEmailWithBody(null,</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406019">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;activity.AssignedUser.Contact,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// To:</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406020">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;null,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// From:</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406021">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Activity not viewed for five days",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Subject:</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406022">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"See activity " + target.Subject + ", due on " + target.TargetDate + ".") // Body:</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406023">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406024">&nbsp;&nbsp;&nbsp;&nbsp;}</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406025">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406026">&nbsp;&nbsp;&nbsp;&nbsp;// Update the escalation date on the assigned activity</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2407240">&nbsp;&nbsp;&nbsp;&nbsp;Transaction.runWithNewBundle( \ bundle -&gt; { </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2407241">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;activity = bundle.add(activity) &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// add the activity to the new bundle</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2407242">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;activity.EscalationDate = java.util.Date.Today&nbsp;}&nbsp;)&nbsp;// update the escalation date</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406028">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406029">&nbsp;&nbsp;&nbsp;&nbsp;return</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406030">&nbsp;&nbsp;}</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406031">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2406032">&nbsp;</a></PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2406033">}</a></PRE>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>