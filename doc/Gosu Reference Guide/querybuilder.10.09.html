<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <!-- MOTW-DISABLED saved from url=(0014)about:internet -->
    <title>Making a Query with a Left Outer Join</title>
    <link rel="StyleSheet" href="css/querybuilder.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" />
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/context.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/towwhdir.js"></script>
    <script type="text/javascript" language="JavaScript1.2" src="wwhdata/common/wwhpagef.js"></script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        var  WebWorksRootPath = "";
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        // Set reference to top level help frame
        //
        var  WWHFrame = WWHGetWWHFrame("", true);
      // -->
    </script>
    <script type="text/javascript" language="JavaScript1.2" src="scripts/expand.js"></script>
    <!-- THE FOLLOWING IS A GUIDEWIRE STYLE DEFINITION FOR THE LINK TO THIS FEATURE -->
    <link rel="StyleSheet" href="css/css-guidewire-extra.css" type="text/css" media="all" />
    <!-- THE FOLLOWING IS A GUIDEWIRE GSCRIPT FUNCTION FOR THE LINK TO THIS FEATURE -->
    <script type="text/javascript">
function guidewire_selectall()
{
var text_val=eval("document.linktothisurlform.urlfield");
text_val.focus();
text_val.select();
}
</script>
  </head>
  <body onLoad="WWHUpdate();" onUnload="WWHUnload();" onKeyDown="WWHHandleKeyDown((document.all||document.getElementById||document.layers)?event:null);" onKeyPress="WWHHandleKeyPress((document.all||document.getElementById||document.layers)?event:null);" onKeyUp="WWHHandleKeyUp((document.all||document.getElementById||document.layers)?event:null);">
    <!-- THE FOLLOWING IS A GUIDEWIRE DIV FOR THE 'LINK TO THIS' FEATURE -->
    <div id="linkToThisPage" class="popup" style="display: none;">
      <div class="popupTitle">Link Directly to This Page 
           <a href="#" onclick="var thePopup = getElementById('linkToThisPage');thePopup.style.display='none';return false;"><img class="popupClosebox" src="wwhelp/wwhimpl/common/images/close.gif" /></a></div>
      <div style="padding:6px;">
        <div class="popupText" id="linkToThisPageBookmark">An error has occurred if you see this messsage.</div>
        <form name="linktothisurlform" method="post" action="" style="width:275px;margin:0px">
          <input type="text" class="popupURLText" id="linkToThisPageURL" name="urlfield" rows="1" cols="55" onClick="guidewire_selectall();" onFocus="guidewire_selectall();"></input>
        </form>
      </div>
    </div>
    <br />
    <div class="WebWorks_Breadcrumbs" style="text-align: left;">
      <span>Gosu Reference Guide</span> : 
    <span class="WebWorks_Breadcrumbs" style="text-align: left;"><a class="WebWorks_Breadcrumb_Link" href="querybuilder.10.01.html#2237905">Query Builder APIs</a> : <a class="WebWorks_Breadcrumb_Link" href="querybuilder.10.04.html#2237905">Joining Related Entities to Queries</a> : Making a Query with a Left Outer Join</span></div>
    <hr align="left" />
    <blockquote>
      <h4 class="H2B_-_Heading_2_Break"><a name="2237905">Making a Query with a Left Outer Join</a></h4>
      <div class="B_-_Body"><a name="2237906">With a left outer join, items from the primary entity on the left are joined to items from the entity on the right, based on matching values. If a primary item on the left has no matching value on the right, that primary item is included in the result, anyway. A foreign key from one side or the other is the basis of matching.</a></div>
      <div class="B_-_Body"><a name="2237908">In SQL, it generally does not matter which side of the join the foreign key is on. It generally does not matter whether the foreign key is defined in metadata. It does not matter if the column or property names are the same. All that matters is for one side of the join to have a column or property with values that match values in the column of another table or property. </a></div>
      <div class="B_-_Body"><a name="2237909">With the query builder APIs, it matters which side of a join the foreign key is on. The side that has the foreign key determines which </a><span class="cv_-_computer_voice">outerJoin</span> method signature to use: </div>
      <div class="BI_-_Bullet_Item_outer" style="margin-left: 57pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <div class="BI_-_Bullet_Item_inner" style="width: 15pt; white-space: nowrap">
                <span class="bu_-_bullet">•	</span>
              </div>
            </td>
            <td width="100%">
              <div class="BI_-_Bullet_Item_inner"><span class="cv_-_computer_voice"><a name="3507678">outerJoin("</a></span><span class="ps_-_parameter_in_code_snippets">column</span><span class="cv_-_computer_voice">")</span> – Joins two entities when the foreign key is on left. </div>
            </td>
          </tr>
        </table>
      </div>
      <div class="H3_-_Heading_3_outer" style="margin-left: 36pt">
        <table border="0" cellspacing="0" cellpadding="0" summary="" role="presentation">
          <tr style="vertical-align: baseline">
            <td>
              <h5 class="H3_-_Heading_3_inner" style="width: 18pt; white-space: nowrap"></h5>
            </td>
            <td width="100%">
              <h5 class="H3_-_Heading_3_inner"><a name="2237922">Making Left Outer Joins with the Foreign Key on the Left</a></h5>
            </td>
          </tr>
        </table>
      </div>
      <div class="B_-_Body"><a name="2237923">In SQL, you make a left outer join with the </a><span class="cv_-_computer_voice">LEFT JOIN</span> keywords. You specify the table that you want to join to the primary table of the query. The <span class="cv_-_computer_voice">ON</span> keyword lets you specify which columns join the tables. In the following SQL statement, the foreign key, <span class="cv_-_computer_voice">supervisor</span>, is on the primary table, <span class="cv_-_computer_voice">groups</span>. So, the foreign key is on the left side. </div>
      <PRE class="CF_-_Code_First_Line"><a name="2237924">SELECT * FROM groups</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237925">&nbsp;&nbsp;&nbsp;&nbsp;</a><span class="s_-_strong">LEFT JOIN</span> users </PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237926">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a><span class="s_-_strong">ON</span> groups.supervisor = users.ID;</PRE>
      <div class="B_-_Body"><a name="2237927">With the query builder APIs, use the </a><span class="cv_-_computer_voice">outerJoin</span> method with a single parameter if the primary entity has the foreign key. In these cases, the foreign key is on the left. You specify a property of the primary entity that the <span class="Emphasis" style="font-style: italic">Data Dictionary</span> defines as a foreign key to the secondary entity. The query builder APIs use metadata to determine the entity type to which the foreign key the relates. </div>
      <h6 class="HS_-_Head_Sub"><a name="2237928">Joining the Secondary Entity to a Query with the Foreign Key on the Left</a></h6>
      <div class="B_-_Body"><a name="3455546">In the following Gosu sample code, the primary entity type, </a><span class="cv_-_computer_voice">Group</span>, has a foreign key, <span class="cv_-_computer_voice">Supervisor</span>, which relates to the secondary entity type, <span class="cv_-_computer_voice">User</span>. </div>
      <PRE class="CF_-_Code_First_Line"><a name="3455547">var queryGroup = Query.make(</a><span class="s_-_strong">Group</span>) </PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="3455548">queryGroup.</a><span class="s_-_strong">outerJoin</span>("Supervisor") // Supervisor is a foreign key from Group to User. </PRE>
      <div class="B_-_Body"><a name="3455549">Notice that unlike SQL, you do not specify which secondary entity to join, in this case </a><span class="cv_-_computer_voice">User</span>. Neither do you specify the property on the secondary entity, <span class="cv_-_computer_voice">ID</span>. The query builder APIs use metadata from the <span class="Emphasis" style="font-style: italic">Data Dictionary</span><span class="Emphasis" style="font-style: normal"> to fill in the missing information. </span></div>
      <h6 class="HS_-_Head_Sub"><a name="2237933">Applying Predicates to the Secondary Entity </a></h6>
      <div class="B_-_Body"><a name="2237934">With the query builder APIs, generally you join a secondary entity to a query only so you can restrict the results with predicates on the secondary entity. Unlike SQL, the result of a query contains entity instances, not table rows with columns. You can access any information related to the primary entity in the result with dot notation, regardless of including the related entity type in the query itself.</a></div>
      <div class="B_-_Body"><a name="2237935">The following Gosu sample codes shows how to use dot notation to access information related to the primary entity of a query. The code accesses the </a><span class="cv_-_computer_voice">DisplayName</span> information for the group supervisor from the <span class="cv_-_computer_voice">User</span> entity with dot notation on <span class="cv_-_computer_voice">Group</span> instances retrieved from the result. </div>
      <PRE class="CF_-_Code_First_Line"><a name="2237936">uses gw.api.database.Query</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237937">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237938">// -- query the Group entity --</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237939">var queryGroup = Query.make(</a><span class="s_-_strong">Group</span>) </PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2237940">queryGroup.</a><span class="s_-_strong">outerJoin</span>("Supervisor") // Supervisor is a foreign key from Group to User.</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237941">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3495989">// -- fetch the Group instances with a for loop and print them --</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3495990">var result = queryGroup.select()</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="3495991">&nbsp;</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237945">for (</a><span class="s_-_strong">group</span> in result) {</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237946">   if (group.Supervisor != null) //-- access the supervisor in a typesafe way --</a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237947">     print (</a><span class="s_-_strong">group.Name</span> + ": " + <span class="s_-_strong">group.Supervisor.Contact.DisplayName</span>)</PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237948">   else </a></PRE>
      <PRE class="CM_-_Code_Middle_Line"><a name="2237949">     print (</a><span class="s_-_strong">group.Name</span> + ": " + "<span class="s_-_strong">group has no supervisor</span>")</PRE>
      <PRE class="CL_-_Code_Last_Line"><a name="2237950">}</a></PRE>
      <script type="text/javascript" language="JavaScript1.2">
        <!--
          // Clear related topics
          //
          WWHClearRelatedTopics();

          document.writeln(WWHRelatedTopicsInlineHTML());
        // -->
      </script>
    </blockquote>
    <script type="text/javascript" language="JavaScript1.2">
      <!--
        document.write(WWHRelatedTopicsDivTag() + WWHPopupDivTag() + WWHALinksDivTag());
      // -->
    </script>
  </body>
</html>